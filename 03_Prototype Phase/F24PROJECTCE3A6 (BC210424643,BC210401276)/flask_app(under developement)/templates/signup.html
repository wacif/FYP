{% extends "base.html" %}
{% block title %}Sign Up{% endblock %}
{% block content %}
    <!-- Animated Background -->
    <div class="network-background"></div>

    <div class="auth-section py-4">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-6 col-lg-5">
                    <div class="card auth-card animate__animated animate__fadeIn">
                        <div class="card-body p-4 p-lg-5">
                            <!-- Logo/Brand -->
                            <div class="text-center mb-4">
                                <i class="fas fa-user-plus fa-3x text-primary mb-3"></i>
                                <h4 class="text-primary mb-0">Create Account</h4>
                                <p class="text-light mb-4">Join our security community</p>
                            </div>

                            <!-- Signup Form -->
                            <form id="signupForm" method="POST" action="{{ url_for('signup') }}">
                                <div class="form-floating mb-4">
                                    <input type="text" class="form-control" id="fullName" name="fullName" placeholder="Full Name" required>
                                    <label for="fullName">Full Name</label>
                                    <div class="form-icon">
                                        <i class="fas fa-user"></i>
                                    </div>
                                </div>

                                <div class="form-floating mb-4">
                                    <input type="email" class="form-control" id="email" name="email" placeholder="name@example.com" required>
                                    <label for="email">Email address</label>
                                    <div class="form-icon">
                                        <i class="fas fa-envelope"></i>
                                    </div>
                                </div>

                                <div class="form-floating mb-4">
                                    <input type="password" class="form-control" id="password" name="password" placeholder="Password" 
                                           pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" 
                                           title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters"
                                           required>
                                    <label for="password">Password</label>
                                    <div class="form-icon">
                                        <i class="fas fa-lock"></i>
                                    </div>
                                    <button type="button" class="btn btn-link password-toggle" onclick="togglePassword('password')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>

                                <div class="form-floating mb-4">
                                    <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" placeholder="Confirm Password" required>
                                    <label for="confirmPassword">Confirm Password</label>
                                    <div class="form-icon">
                                        <i class="fas fa-lock"></i>
                                    </div>
                                    <button type="button" class="btn btn-link password-toggle" onclick="togglePassword('confirmPassword')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>

                                <div class="password-strength mb-4 d-none" id="passwordStrength">
                                    <h6 class="text-primary mb-2">Password Strength</h6>
                                    <div class="progress mb-2" style="height: 5px;">
                                        <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                                    </div>
                                    <div class="requirements text-light">
                                        <small class="d-block mb-1"><i class="fas fa-circle text-muted me-2"></i>At least 8 characters</small>
                                        <small class="d-block mb-1"><i class="fas fa-circle text-muted me-2"></i>One uppercase letter</small>
                                        <small class="d-block mb-1"><i class="fas fa-circle text-muted me-2"></i>One lowercase letter</small>
                                        <small class="d-block"><i class="fas fa-circle text-muted me-2"></i>One number</small>
                                    </div>
                                </div>

                                <div class="form-check mb-4">
                                    <input type="checkbox" class="form-check-input" id="terms" required>
                                    <label class="form-check-label text-light" for="terms">
                                        I agree to the <a href="#" class="text-primary">Terms of Service</a> and <a href="#" class="text-primary">Privacy Policy</a>
                                    </label>
                                </div>

                                <button type="submit" class="btn btn-primary w-100 mb-4">
                                    <i class="fas fa-user-plus me-2"></i>Create Account
                                </button>

                                <div class="text-center">
                                    <p class="text-light mb-0">Already have an account? 
                                        <a href="{{ url_for('login') }}" class="text-primary text-decoration-none">Login</a>
                                    </p>
                                </div>
                            </form>

                            <!-- Social Signup -->
                            <div class="social-login text-center mt-4">
                                <p class="text-light mb-3">Or sign up with</p>
                                <div class="d-flex justify-content-center gap-3">
                                    <button class="btn btn-outline-light social-btn">
                                        <i class="fab fa-google"></i>
                                    </button>
                                    <button class="btn btn-outline-light social-btn">
                                        <i class="fab fa-github"></i>
                                    </button>
                                    <button class="btn btn-outline-light social-btn">
                                        <i class="fab fa-linkedin"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        .auth-card {
            background: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .form-floating {
            position: relative;
        }

        .form-control {
            background-color: rgba(255, 255, 255, 0.05) !important;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-primary) !important;
            height: 56px;
            padding-left: 45px !important;
        }

        .form-control:focus {
            background-color: rgba(255, 255, 255, 0.1) !important;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(99, 102, 241, 0.25);
        }

        .form-floating > label {
            padding-left: 45px;
            color: var(--text-secondary);
        }

        .form-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            z-index: 2;
        }

        .password-toggle {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            z-index: 2;
            padding: 0;
            background: none;
            border: none;
        }

        .password-toggle:hover {
            color: var(--primary-color);
        }

        .password-strength .progress-bar {
            transition: width 0.3s ease;
        }

        .password-strength .requirements small {
            transition: color 0.3s ease;
        }

        .password-strength .requirements small i {
            font-size: 8px;
            transition: color 0.3s ease;
        }

        .form-check-input {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .form-check-input:checked {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .social-btn {
            width: 45px;
            height: 45px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .social-btn:hover {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            transform: translateY(-3px);
        }

        @media (max-width: 576px) {
            .auth-card {
                margin: 1rem;
            }
        }
    </style>

    <script>
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const icon = input.nextElementSibling.nextElementSibling.querySelector('i');
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        // Password strength checker
        const password = document.getElementById('password');
        const strengthMeter = document.getElementById('passwordStrength');
        const progressBar = strengthMeter.querySelector('.progress-bar');
        const requirements = strengthMeter.querySelectorAll('.requirements small');

        password.addEventListener('focus', () => {
            strengthMeter.classList.remove('d-none');
        });

        password.addEventListener('input', () => {
            const value = password.value;
            let strength = 0;
            let color = '';

            // Length check
            if (value.length >= 8) {
                strength += 25;
                requirements[0].style.color = '#10b981';
                requirements[0].querySelector('i').style.color = '#10b981';
            } else {
                requirements[0].style.color = '';
                requirements[0].querySelector('i').style.color = '';
            }

            // Uppercase check
            if (/[A-Z]/.test(value)) {
                strength += 25;
                requirements[1].style.color = '#10b981';
                requirements[1].querySelector('i').style.color = '#10b981';
            } else {
                requirements[1].style.color = '';
                requirements[1].querySelector('i').style.color = '';
            }

            // Lowercase check
            if (/[a-z]/.test(value)) {
                strength += 25;
                requirements[2].style.color = '#10b981';
                requirements[2].querySelector('i').style.color = '#10b981';
            } else {
                requirements[2].style.color = '';
                requirements[2].querySelector('i').style.color = '';
            }

            // Number check
            if (/\d/.test(value)) {
                strength += 25;
                requirements[3].style.color = '#10b981';
                requirements[3].querySelector('i').style.color = '#10b981';
            } else {
                requirements[3].style.color = '';
                requirements[3].querySelector('i').style.color = '';
            }

            // Set progress bar color
            if (strength <= 25) color = '#ef4444';
            else if (strength <= 50) color = '#f59e0b';
            else if (strength <= 75) color = '#10b981';
            else color = '#10b981';

            progressBar.style.width = strength + '%';
            progressBar.style.backgroundColor = color;
        });

        // Form submission
        document.getElementById('signupForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Password match validation
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (password !== confirmPassword) {
                const alert = document.createElement('div');
                alert.className = 'alert alert-danger animate__animated animate__fadeIn mt-3';
                alert.innerHTML = `
                    <i class="fas fa-exclamation-circle me-2"></i>
                    Passwords do not match!
                `;
                this.appendChild(alert);
                return;
            }

            const button = this.querySelector('button[type="submit"]');
            const originalContent = button.innerHTML;
            
            // Show loading state
            button.classList.add('btn-loading');
            button.innerHTML = `
                <span>${originalContent}</span>
                <div class="spinner-border spinner-border-sm" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            `;

            // Simulate API call
            setTimeout(() => {
                // Reset button state
                button.classList.remove('btn-loading');
                button.innerHTML = originalContent;
                
                // Show success message
                const alert = document.createElement('div');
                alert.className = 'alert alert-success animate__animated animate__fadeIn mt-3';
                alert.innerHTML = `
                    <i class="fas fa-check-circle me-2"></i>
                    Account created successfully! Redirecting...
                `;
                this.appendChild(alert);

                // Redirect after success
                setTimeout(() => {
                    window.location.href = '/login';
                }, 1500);
            }, 2000);
        });
    </script>
{% endblock %} 